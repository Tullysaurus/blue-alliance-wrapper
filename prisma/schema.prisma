// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Event {
  id Int @id @default(autoincrement())

  // TBA event key with the format yyyy[EVENT_CODE], where yyyy is the year, and EVENT_CODE is the event code of the event.  
  key       String
  // Official name of event on record either provided by FIRST or organizers of offseason event.
  name      String
  // Event short code, as provided by FIRST.
  eventCode String
  // Event Type, meaning currently unknown
  eventType Int

  // District information
  district District?

  city      String?
  stateProv String?
  country   String?
  startDate DateTime
  endDate   DateTime
  week      Int
  year      Int

  // Same as `name` but doesn't include event specifiers, such as 'Regional' or 'District'. May be null.
  shortName       String?
  // Event Type, eg Regional, District, or Offseason.
  eventTypeString String

  address      String?
  postalCode   String?
  gmapsPlaceId String?
  gmapsUrl     String?
  lat          Float?
  lng          Float?
  locationName String?
  timezone     String?
  website      String?

  // The FIRST internal Event ID, used to link to the event on the FRC webpage.
  firstEventId   String?
  // Public facing event code used by FIRST (on frc-events.firstinspires.org, for example)
  firstEventCode String?

  webcasts Webcast[]

  // An array of event keys for the divisions at this event.
  divisionKeys   String[]
  // The TBA Event key that represents the event's parent. Used to link back to the event from a division event. It is also the inverse relation of `divison_keys`.
  parentEventKey String?

  // Event Type, meaning currently unknown
  playoffType       Int?
  // String representation of the `playoff_type`, or null.
  playoffTypestring String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model District {
  id Int @id @default(autoincrement())

  key          String @unique
  abbreviation String
  displayName  String
  year         Int

  eventId Int?   @unique
  event   Event? @relation(fields: [eventId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum WebcastEnum {
  youtube
  twitch
  ustream
  iframe
  html5
  rtmp
  livestream
  direct_link
  mms
  justin
  stemtv
  dacast
}

model Webcast {
  id Int @id @default(autoincrement())

  // Type of webcast, typically descriptive of the streaming provider.
  type WebcastEnum

  // Type specific channel information. May be the YouTube stream, or Twitch channel name. In the case of iframe types, contains HTML to embed the stream in an HTML iframe.
  channel String

  date DateTime?

  // File identification as may be required for some types. May be null.
  file String?

  eventId Int?
  events Event? @relation(fields:[eventId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
